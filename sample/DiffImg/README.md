# 图像比对算法

这是一个使用C++和OpenCV实现的图像比对工具，用于判断两张图片是否是同一张画面。

## 功能特点

本工具使用多种算法综合判断图像相似度：

1. **SSIM (结构相似性指数)**: 评估图像的结构相似性，权重40%
2. **感知哈希 (pHash)**: 基于DCT的感知哈希算法，权重30%
3. **特征点匹配**: 使用ORB特征检测器进行特征匹配，权重20%
4. **直方图相似度**: 基于颜色直方图的相似度比较，权重10%

综合相似度阈值设置为0.85，超过此值判定为同一画面。

## 编译要求

- CMake 3.10 或更高版本
- C++17 编译器
- OpenCV 4.x 或更高版本

## 编译步骤

### Windows (使用Visual Studio)

```bash
mkdir build
cd build
cmake .. -G "Visual Studio 16 2019" -A x64
cmake --build . --config Release
```

### Linux/macOS

```bash
mkdir build
cd build
cmake ..
make
```

## 使用方法

编译完成后，在build目录下运行：

```bash
./image_comparison <图片1路径> <图片2路径>
```

### 示例

```bash
./image_comparison image1.jpg image2.jpg
```

## 输出说明

程序会输出以下信息：

- **SSIM相似度**: 结构相似性指数，范围0-1，值越大越相似
- **感知哈希相似度**: 基于哈希的相似度，范围0-1
- **特征匹配相似度**: 特征点匹配率，范围0-1
- **直方图相似度**: 颜色直方图相关性，范围0-1
- **综合相似度**: 加权平均后的综合评分
- **判断结果**: 是否为同一画面

## 算法说明

### SSIM (结构相似性指数)
SSIM通过比较图像的亮度、对比度和结构来评估相似度，能够更好地反映人眼感知的相似性。

### 感知哈希
将图像转换为8x8的DCT系数，然后生成二进制哈希值。对图像的缩放、亮度变化等具有较好的鲁棒性。

### 特征点匹配
使用ORB (Oriented FAST and Rotated BRIEF) 特征检测器提取关键点，通过特征匹配来判断图像相似度。

### 直方图相似度
比较图像的颜色直方图，使用相关性系数来衡量相似度。

## 注意事项

- 程序会自动调整第二张图片的尺寸以匹配第一张图片
- 阈值0.85可以根据实际需求调整
- 支持常见的图像格式（jpg, png, bmp等）

## 依赖库

- OpenCV: 用于图像处理和特征检测

## 许可证

本项目仅供学习和研究使用。
